<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚·ãƒ³ãƒ—ãƒ«äº¤é€šãƒ©ã‚¸ã‚ª</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            padding: 20px;
            background-color: #f0f0f0;
            color: #333;
        }
        h1 { font-size: 1.5rem; margin-bottom: 1rem; }
        .status {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            font-weight: bold;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        button {
            font-size: 1.2rem;
            padding: 15px 30px;
            margin: 10px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            width: 80%;
            max-width: 300px;
        }
        #btn-play { background-color: #007bff; color: white; }
        #btn-stop { background-color: #dc3545; color: white; display: none; }
    </style>
</head>
<body>

    <h1>ğŸš— äº¤é€šæƒ…å ±ãƒ©ã‚¸ã‚ª</h1>
    
    <div class="status" id="status-text">åœæ­¢ä¸­</div>

    <button id="btn-play" onclick="startRadio()">å†ç”Ÿã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    <button id="btn-stop" onclick="stopRadio()">åœæ­¢</button>

    <p style="font-size: 0.8rem; margin-top: 30px; color: #666;">
        â€»ã‚¹ãƒãƒ›ã®ç”»é¢ãŒæ¶ˆãˆã‚‹ã¨éŸ³å£°ãŒæ­¢ã¾ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>ç”»é¢ã¯ç‚¹ã‘ãŸã¾ã¾ã«ã—ã¦ãã ã•ã„ã€‚
    </p>

    <script>
        // ã“ã“ã«èª­ã¿ä¸Šã’ãŸã„æƒ…å ±ã‚’ãƒªã‚¹ãƒˆã§å…¥ã‚Œã¾ã™
        // å°†æ¥çš„ã«ã¯ã“ã“ã‚’è‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆã¾ã™
        const trafficInfoList = [
            "ã“ã¡ã‚‰ã¯ã€äº¤é€šæƒ…å ±ãƒ©ã‚¸ã‚ªã§ã™ã€‚",
            "ç¾åœ¨ã€é¦–éƒ½é«˜é€Ÿéƒ½å¿ƒç’°çŠ¶ç·šã€å¤–å›ã‚Šã€éŠ€åº§ä»˜è¿‘ã§äº‹æ•…ã®ãŸã‚2ã‚­ãƒ­ã®æ¸‹æ»ã§ã™ã€‚",
            "æ±åé«˜é€Ÿé“è·¯ã€ä¸‹ã‚Šã€æµ·è€åã‚µãƒ¼ãƒ“ã‚¹ã‚¨ãƒªã‚¢ä»˜è¿‘ã€äº¤é€šé‡ã¯å¤šã„ã§ã™ãŒæµã‚Œã¦ã„ã¾ã™ã€‚",
            "ä¸­å¤®é“ã€ä¸Šã‚Šã€å°ä»ãƒˆãƒ³ãƒãƒ«å…ˆé ­ã«ã€æ–­ç¶šçš„ãªæ¸‹æ»ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚",
            "æ¬¡ã®æƒ…å ±ã¯ã€ã¾ãŸã™ãã«ãŠä¼ãˆã—ã¾ã™ã€‚",
            "..." // å°‘ã—é–“ã‚’é–‹ã‘ã‚‹ãŸã‚ã®ãƒ€ãƒŸãƒ¼
        ];

        let isPlaying = false;
        let currentLine = 0;
        const synth = window.speechSynthesis;
        let currentUtterance = null;

        function startRadio() {
            if (isPlaying) return;
            isPlaying = true;
            
            // iOSãªã©ã§å†ç”Ÿã‚’å®‰å®šã•ã›ã‚‹ãŸã‚ã®ãŠã¾ã˜ãªã„ï¼ˆç©ºã®éŸ³å£°ã‚’ä¸€åº¦å†ç”Ÿï¼‰
            synth.cancel();
            
            document.getElementById('btn-play').style.display = 'none';
            document.getElementById('btn-stop').style.display = 'inline-block';
            document.getElementById('status-text').innerText = "æ”¾é€ä¸­...";
            document.getElementById('status-text').style.backgroundColor = "#e6f7ff";

            speakNextLine();
        }

        function stopRadio() {
            isPlaying = false;
            synth.cancel(); // éŸ³å£°ã‚’å¼·åˆ¶åœæ­¢
            document.getElementById('btn-play').style.display = 'inline-block';
            document.getElementById('btn-stop').style.display = 'none';
            document.getElementById('status-text').innerText = "åœæ­¢ä¸­";
            document.getElementById('status-text').style.backgroundColor = "white";
        }

        function speakNextLine() {
            if (!isPlaying) return;

            const text = trafficInfoList[currentLine];
            
            // èª­ã¿ä¸Šã’è¨­å®š
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ja-JP';
            utterance.rate = 1.0; // é€Ÿåº¦ (0.1 ~ 10)
            utterance.pitch = 1.0; // é«˜ã• (0 ~ 2)

            // èª­ã¿ä¸Šã’ãŒçµ‚ã‚ã£ãŸã‚‰æ¬¡ã®è¡Œã¸
            utterance.onend = function() {
                if (!isPlaying) return;
                
                currentLine++;
                if (currentLine >= trafficInfoList.length) {
                    currentLine = 0; // æœ€åˆã«æˆ»ã‚‹ï¼ˆãƒ«ãƒ¼ãƒ—ï¼‰
                }
                // å°‘ã—ã ã‘é–“éš”ã‚’ã‚ã‘ã¦æ¬¡ã‚’å‘¼ã¶
                setTimeout(speakNextLine, 500);
            };

            // ã‚¨ãƒ©ãƒ¼å¯¾ç­–ï¼ˆèª­ã¿ä¸Šã’ãŒæ­¢ã¾ã£ã¦ã—ã¾ã£ãŸå ´åˆãªã©ï¼‰
            utterance.onerror = function(event) {
                console.error("Speech error", event);
                // ã‚¨ãƒ©ãƒ¼ã§ã‚‚æ­¢ã¾ã‚‰ãšæ¬¡ã¸é€²ã‚€
                setTimeout(speakNextLine, 1000);
            };

            synth.speak(utterance);
            document.getElementById('status-text').innerText = "èª­ã¿ä¸Šã’ä¸­: " + text;
        }
    </script>
</body>
</html>
